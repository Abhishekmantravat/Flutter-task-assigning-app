
class UpdateProfileScreen extends StatefulWidget {
  const UpdateProfileScreen({Key? key}) : super(key: key);
  @override
  State<UpdateProfileScreen> createState() => _UpdateProfileScreenState();
}
class _UpdateProfileScreenState extends State<UpdateProfileScreen> {
  @override
  Widget build(BuildContext context) {
    final db=FirebaseFirestore.instance;
    final auth=FirebaseAuth.instance;
    return Scaffold(
      appBar: AppBar(
        leading: IconButton(onPressed: () {
          Get.back();
        },
            icon: const Icon(LineAwesomeIcons.angle_left)),
        title: Text("Profile", style: Theme
            .of(context)
            .textTheme
            .headlineMedium,),
      ),
    body: SingleChildScrollView(
      child: Column(
        children: [
          Container(
          padding: EdgeInsets.all(tDefaultSize),
          child:StreamBuilder(
            stream: db.collection("users").where('id',isEqualTo: auth.currentUser!.uid).snapshots(),
            builder: (context, AsyncSnapshot<QuerySnapshot> snapshot) {
                                if(snapshot.hasData){
                                return ListView.builder(
                                  itemCount: snapshot.data!.docs.length,
                                  shrinkWrap: true,
                                   itemBuilder: (context,i){
                                     var data=snapshot.data!.docs[i];
                  // final email= TextEditingController(text:data['email']);
                  // final password= TextEditingController(text:data['password'] );
                  final fullName= TextEditingController(text: data['fullName']);
                  final phoneNo= TextEditingController(text: data['phoneNo']);
                  return Column(
                      children: [
                        Stack(
                          children: [
                            SizedBox(
                              width: 120,
                              height: 120,
                              child: ClipRRect(
                                borderRadius:BorderRadius.circular(100),
                                child: const Image(image: AssetImage(tProfileImage)),
                              ),
                            ),
                            Positioned(
                                bottom: 0,
                                right: 0,
                                child: Container(
                                  width: 30,height: 30,
                                  decoration: BoxDecoration(
                                    borderRadius: BorderRadius.circular(100),
                                    color: tPrimaryColor,
                                  ),
                                  child: Icon(LineAwesomeIcons.camera,color:Colors.black,size: 20,),
                                )
                            )],),
                        const SizedBox(height: 50,),
                        Form(
                          child: Column(
                              children: [
                                TextFormField(
                                  controller: fullName,
                                  decoration: const InputDecoration(
                                    label: Text("Full Name"),
                                    prefixIcon: Icon(Icons.person_2_outlined),
                                  ),
                                ),
                                SizedBox(height: tFormHeight-20,),
                                // TextFormField(
                                //   controller: email,
                                //   decoration: const InputDecoration(
                                //     label: Text("Email"),
                                //     prefixIcon: Icon(Icons.mail),
                                //   ),
                                // ),
                                SizedBox(height: tFormHeight-20,),
                                TextFormField(
                                  controller: phoneNo,
                                  decoration: const InputDecoration(
                                    label: Text("Phone No"),
                                    prefixIcon: Icon(Icons.phone),
                                  ),
                                ),
                                SizedBox(height: tFormHeight-20,),
                                // TextFormField(
                                //   controller: password,
                                //   decoration: const InputDecoration(
                                //     label: Text("Password"),
                                //     prefixIcon: Icon(Icons.lock),
                                //   ),
                                // ),
                                const SizedBox(height: 10,),
                                SizedBox(
                                  width: double.infinity,
                                  child: ElevatedButton(onPressed: (){
                                  db.collection('users').doc(auth.currentUser!.uid).update({
                                      //  'email': email.text.trim(),
                                      //  'password': password.text.trim(),
                                       'fullName':fullName.text.trim(),
                                       'phoneNo': phoneNo.text.trim(),
                                   }).then((value) => Get.snackbar("Success", "Data Updated"));
                                  },
                                    child: const Text("Edit Profile",style: TextStyle(color: tDarkColor),),
                                    style: ElevatedButton.styleFrom(
                                        backgroundColor: tPrimaryColor,side: BorderSide.none,
                                        shape: StadiumBorder()),
                                  ),),
                              ]) ,
                                )]);
                                   });}
              else{
                return const Center(child: CircularProgressIndicator(),);
              }
            },
          )),